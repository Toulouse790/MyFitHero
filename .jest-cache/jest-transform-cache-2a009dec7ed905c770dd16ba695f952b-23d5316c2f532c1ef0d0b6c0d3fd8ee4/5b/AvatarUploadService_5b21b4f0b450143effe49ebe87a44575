d157724f718c647f0b308c74f7b7d4e7
"use strict";

/* istanbul ignore next */
function cov_24fpaoe66e() {
  var path = "/workspaces/MyFitHero/src/features/profile/components/avatar/AvatarUploadService.tsx";
  var hash = "b838d4bff9b257eebffadf741244a35dcb5f8464";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/MyFitHero/src/features/profile/components/avatar/AvatarUploadService.tsx",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 2,
          column: 62
        }
      },
      "1": {
        start: {
          line: 3,
          column: 0
        },
        end: {
          line: 3,
          column: 37
        }
      },
      "2": {
        start: {
          line: 5,
          column: 19
        },
        end: {
          line: 5,
          column: 44
        }
      },
      "3": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 50,
          column: 9
        }
      },
      "4": {
        start: {
          line: 10,
          column: 28
        },
        end: {
          line: 10,
          column: 54
        }
      },
      "5": {
        start: {
          line: 11,
          column: 29
        },
        end: {
          line: 11,
          column: 65
        }
      },
      "6": {
        start: {
          line: 12,
          column: 29
        },
        end: {
          line: 12,
          column: 50
        }
      },
      "7": {
        start: {
          line: 14,
          column: 43
        },
        end: {
          line: 19,
          column: 14
        }
      },
      "8": {
        start: {
          line: 20,
          column: 12
        },
        end: {
          line: 22,
          column: 13
        }
      },
      "9": {
        start: {
          line: 21,
          column: 16
        },
        end: {
          line: 21,
          column: 34
        }
      },
      "10": {
        start: {
          line: 24,
          column: 44
        },
        end: {
          line: 26,
          column: 39
        }
      },
      "11": {
        start: {
          line: 27,
          column: 30
        },
        end: {
          line: 27,
          column: 53
        }
      },
      "12": {
        start: {
          line: 29,
          column: 43
        },
        end: {
          line: 35,
          column: 33
        }
      },
      "13": {
        start: {
          line: 36,
          column: 12
        },
        end: {
          line: 38,
          column: 13
        }
      },
      "14": {
        start: {
          line: 37,
          column: 16
        },
        end: {
          line: 37,
          column: 34
        }
      },
      "15": {
        start: {
          line: 39,
          column: 12
        },
        end: {
          line: 42,
          column: 14
        }
      },
      "16": {
        start: {
          line: 45,
          column: 12
        },
        end: {
          line: 45,
          column: 58
        }
      },
      "17": {
        start: {
          line: 46,
          column: 12
        },
        end: {
          line: 49,
          column: 14
        }
      },
      "18": {
        start: {
          line: 53,
          column: 8
        },
        end: {
          line: 75,
          column: 9
        }
      },
      "19": {
        start: {
          line: 55,
          column: 38
        },
        end: {
          line: 61,
          column: 33
        }
      },
      "20": {
        start: {
          line: 62,
          column: 12
        },
        end: {
          line: 64,
          column: 13
        }
      },
      "21": {
        start: {
          line: 63,
          column: 16
        },
        end: {
          line: 63,
          column: 29
        }
      },
      "22": {
        start: {
          line: 65,
          column: 12
        },
        end: {
          line: 67,
          column: 14
        }
      },
      "23": {
        start: {
          line: 70,
          column: 12
        },
        end: {
          line: 70,
          column: 63
        }
      },
      "24": {
        start: {
          line: 71,
          column: 12
        },
        end: {
          line: 74,
          column: 14
        }
      },
      "25": {
        start: {
          line: 78,
          column: 0
        },
        end: {
          line: 78,
          column: 50
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 4
          },
          end: {
            line: 7,
            column: 5
          }
        },
        loc: {
          start: {
            line: 7,
            column: 44
          },
          end: {
            line: 51,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 52,
            column: 4
          },
          end: {
            line: 52,
            column: 5
          }
        },
        loc: {
          start: {
            line: 52,
            column: 38
          },
          end: {
            line: 76,
            column: 5
          }
        },
        line: 52
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 20,
            column: 12
          },
          end: {
            line: 22,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 20,
            column: 12
          },
          end: {
            line: 22,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 20
      },
      "1": {
        loc: {
          start: {
            line: 36,
            column: 12
          },
          end: {
            line: 38,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 36,
            column: 12
          },
          end: {
            line: 38,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 36
      },
      "2": {
        loc: {
          start: {
            line: 62,
            column: 12
          },
          end: {
            line: 64,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 62,
            column: 12
          },
          end: {
            line: 64,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 62
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0
    },
    f: {
      "0": 0,
      "1": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0]
    },
    inputSourceMap: {
      file: "/workspaces/MyFitHero/src/features/profile/components/avatar/AvatarUploadService.tsx",
      mappings: ";;;AACA,iEAAiE;AACjE,6CAA0C;AAQ1C,MAAa,mBAAmB;IAC9B,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,IAAU,EAAE,MAAc;QAClD,IAAI,CAAC;YACH,mCAAmC;YACnC,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC;YAC3C,MAAM,QAAQ,GAAG,GAAG,MAAM,IAAI,IAAI,CAAC,GAAG,EAAE,IAAI,OAAO,EAAE,CAAC;YACtD,MAAM,QAAQ,GAAG,WAAW,QAAQ,EAAE,CAAC;YAEvC,+BAA+B;YAC/B,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,MAAM,mBAAQ,CAAC,OAAO;iBAClD,IAAI,CAAC,cAAc,CAAC;iBACpB,MAAM,CAAC,QAAQ,EAAE,IAAI,EAAE;gBACtB,YAAY,EAAE,MAAM;gBACpB,MAAM,EAAE,IAAI;aACb,CAAC,CAAC;YAEL,IAAI,WAAW,EAAE,CAAC;gBAChB,MAAM,WAAW,CAAC;YACpB,CAAC;YAED,yBAAyB;YACzB,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG,mBAAQ,CAAC,OAAO;iBAC7C,IAAI,CAAC,cAAc,CAAC;iBACpB,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE1B,MAAM,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC;YAE1C,sCAAsC;YACtC,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,MAAO,mBAAgB;iBACnD,IAAI,CAAC,eAAe,CAAC;iBACrB,MAAM,CAAC;gBACN,UAAU,EAAE,SAAS;gBACrB,UAAU,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;aACrC,CAAC;iBACD,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;YAEpB,IAAI,WAAW,EAAE,CAAC;gBAChB,MAAM,WAAW,CAAC;YACpB,CAAC;YAED,OAAO;gBACL,OAAO,EAAE,IAAI;gBACb,SAAS;aACV,CAAC;QACJ,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAC;YAC9C,OAAO;gBACL,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,0CAA0C;aAClD,CAAC;QACJ,CAAC;IACH,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,MAAc;QACtC,IAAI,CAAC;YACH,sBAAsB;YACtB,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,MAAO,mBAAgB;iBAC9C,IAAI,CAAC,eAAe,CAAC;iBACrB,MAAM,CAAC;gBACN,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;aACrC,CAAC;iBACD,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;YAEpB,IAAI,MAAM,EAAE,CAAC;gBACX,MAAM,MAAM,CAAC;YACf,CAAC;YAED,OAAO;gBACL,OAAO,EAAE,IAAI;aACd,CAAC;QACJ,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,KAAK,CAAC,CAAC;YACnD,OAAO;gBACL,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,sCAAsC;aAC9C,CAAC;QACJ,CAAC;IACH,CAAC;CACF;AA/ED,kDA+EC",
      names: [],
      sources: ["/workspaces/MyFitHero/src/features/profile/components/avatar/AvatarUploadService.tsx"],
      sourcesContent: ["import React from 'react';\n// src/features/profile/components/avatar/AvatarUploadService.tsx\nimport { supabase } from '@/lib/supabase';\n\nexport interface UploadResult {\n  success: boolean;\n  avatarUrl?: string;\n  error?: string;\n}\n\nexport class AvatarUploadService {\n  static async uploadAvatar(file: File, userId: string): Promise<UploadResult> {\n    try {\n      // G\xE9n\xE9rer un nom de fichier unique\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${userId}-${Date.now()}.${fileExt}`;\n      const filePath = `avatars/${fileName}`;\n\n      // Upload vers Supabase Storage\n      const { error: uploadError } = await supabase.storage\n        .from('user-avatars')\n        .upload(filePath, file, {\n          cacheControl: '3600',\n          upsert: true,\n        });\n\n      if (uploadError) {\n        throw uploadError;\n      }\n\n      // Obtenir l'URL publique\n      const { data: publicUrlData } = supabase.storage\n        .from('user-avatars')\n        .getPublicUrl(filePath);\n\n      const avatarUrl = publicUrlData.publicUrl;\n\n      // Mettre \xE0 jour le profil utilisateur\n      const { error: updateError } = await (supabase as any)\n        .from('user_profiles')\n        .update({\n          avatar_url: avatarUrl,\n          updated_at: new Date().toISOString(),\n        })\n        .eq('id', userId);\n\n      if (updateError) {\n        throw updateError;\n      }\n\n      return {\n        success: true,\n        avatarUrl,\n      };\n    } catch (error: any) {\n      console.error('Erreur upload avatar:', error);\n      return {\n        success: false,\n        error: 'Impossible de mettre \xE0 jour votre photo.',\n      };\n    }\n  }\n\n  static async removeAvatar(userId: string): Promise<UploadResult> {\n    try {\n      // Supprimer du profil\n      const { error: _error } = await (supabase as any)\n        .from('user_profiles')\n        .update({\n          avatar_url: null,\n          updated_at: new Date().toISOString(),\n        })\n        .eq('id', userId);\n\n      if (_error) {\n        throw _error;\n      }\n\n      return {\n        success: true,\n      };\n    } catch (error: any) {\n      console.error('Erreur suppression avatar:', error);\n      return {\n        success: false,\n        error: 'Impossible de supprimer votre photo.',\n      };\n    }\n  }\n}"],
      version: 3
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "b838d4bff9b257eebffadf741244a35dcb5f8464"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_24fpaoe66e = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_24fpaoe66e();
cov_24fpaoe66e().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_24fpaoe66e().s[1]++;
exports.AvatarUploadService = void 0;
// src/features/profile/components/avatar/AvatarUploadService.tsx
const supabase_1 =
/* istanbul ignore next */
(cov_24fpaoe66e().s[2]++, require("@/lib/supabase"));
class AvatarUploadService {
  static async uploadAvatar(file, userId) {
    /* istanbul ignore next */
    cov_24fpaoe66e().f[0]++;
    cov_24fpaoe66e().s[3]++;
    try {
      // Générer un nom de fichier unique
      const fileExt =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[4]++, file.name.split('.').pop());
      const fileName =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[5]++, `${userId}-${Date.now()}.${fileExt}`);
      const filePath =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[6]++, `avatars/${fileName}`);
      // Upload vers Supabase Storage
      const {
        error: uploadError
      } =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[7]++, await supabase_1.supabase.storage.from('user-avatars').upload(filePath, file, {
        cacheControl: '3600',
        upsert: true
      }));
      /* istanbul ignore next */
      cov_24fpaoe66e().s[8]++;
      if (uploadError) {
        /* istanbul ignore next */
        cov_24fpaoe66e().b[0][0]++;
        cov_24fpaoe66e().s[9]++;
        throw uploadError;
      } else
      /* istanbul ignore next */
      {
        cov_24fpaoe66e().b[0][1]++;
      }
      // Obtenir l'URL publique
      const {
        data: publicUrlData
      } =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[10]++, supabase_1.supabase.storage.from('user-avatars').getPublicUrl(filePath));
      const avatarUrl =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[11]++, publicUrlData.publicUrl);
      // Mettre à jour le profil utilisateur
      const {
        error: updateError
      } =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[12]++, await supabase_1.supabase.from('user_profiles').update({
        avatar_url: avatarUrl,
        updated_at: new Date().toISOString()
      }).eq('id', userId));
      /* istanbul ignore next */
      cov_24fpaoe66e().s[13]++;
      if (updateError) {
        /* istanbul ignore next */
        cov_24fpaoe66e().b[1][0]++;
        cov_24fpaoe66e().s[14]++;
        throw updateError;
      } else
      /* istanbul ignore next */
      {
        cov_24fpaoe66e().b[1][1]++;
      }
      cov_24fpaoe66e().s[15]++;
      return {
        success: true,
        avatarUrl
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_24fpaoe66e().s[16]++;
      console.error('Erreur upload avatar:', error);
      /* istanbul ignore next */
      cov_24fpaoe66e().s[17]++;
      return {
        success: false,
        error: 'Impossible de mettre à jour votre photo.'
      };
    }
  }
  static async removeAvatar(userId) {
    /* istanbul ignore next */
    cov_24fpaoe66e().f[1]++;
    cov_24fpaoe66e().s[18]++;
    try {
      // Supprimer du profil
      const {
        error: _error
      } =
      /* istanbul ignore next */
      (cov_24fpaoe66e().s[19]++, await supabase_1.supabase.from('user_profiles').update({
        avatar_url: null,
        updated_at: new Date().toISOString()
      }).eq('id', userId));
      /* istanbul ignore next */
      cov_24fpaoe66e().s[20]++;
      if (_error) {
        /* istanbul ignore next */
        cov_24fpaoe66e().b[2][0]++;
        cov_24fpaoe66e().s[21]++;
        throw _error;
      } else
      /* istanbul ignore next */
      {
        cov_24fpaoe66e().b[2][1]++;
      }
      cov_24fpaoe66e().s[22]++;
      return {
        success: true
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_24fpaoe66e().s[23]++;
      console.error('Erreur suppression avatar:', error);
      /* istanbul ignore next */
      cov_24fpaoe66e().s[24]++;
      return {
        success: false,
        error: 'Impossible de supprimer votre photo.'
      };
    }
  }
}
/* istanbul ignore next */
cov_24fpaoe66e().s[25]++;
exports.AvatarUploadService = AvatarUploadService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzdXBhYmFzZV8xIiwiY292XzI0ZnBhb2U2NmUiLCJzIiwicmVxdWlyZSIsIkF2YXRhclVwbG9hZFNlcnZpY2UiLCJ1cGxvYWRBdmF0YXIiLCJmaWxlIiwidXNlcklkIiwiZiIsImZpbGVFeHQiLCJuYW1lIiwic3BsaXQiLCJwb3AiLCJmaWxlTmFtZSIsIkRhdGUiLCJub3ciLCJmaWxlUGF0aCIsImVycm9yIiwidXBsb2FkRXJyb3IiLCJzdXBhYmFzZSIsInN0b3JhZ2UiLCJmcm9tIiwidXBsb2FkIiwiY2FjaGVDb250cm9sIiwidXBzZXJ0IiwiYiIsImRhdGEiLCJwdWJsaWNVcmxEYXRhIiwiZ2V0UHVibGljVXJsIiwiYXZhdGFyVXJsIiwicHVibGljVXJsIiwidXBkYXRlRXJyb3IiLCJ1cGRhdGUiLCJhdmF0YXJfdXJsIiwidXBkYXRlZF9hdCIsInRvSVNPU3RyaW5nIiwiZXEiLCJzdWNjZXNzIiwiY29uc29sZSIsInJlbW92ZUF2YXRhciIsIl9lcnJvciIsImV4cG9ydHMiXSwic291cmNlcyI6WyIvd29ya3NwYWNlcy9NeUZpdEhlcm8vc3JjL2ZlYXR1cmVzL3Byb2ZpbGUvY29tcG9uZW50cy9hdmF0YXIvQXZhdGFyVXBsb2FkU2VydmljZS50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0Jztcbi8vIHNyYy9mZWF0dXJlcy9wcm9maWxlL2NvbXBvbmVudHMvYXZhdGFyL0F2YXRhclVwbG9hZFNlcnZpY2UudHN4XG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcblxuZXhwb3J0IGludGVyZmFjZSBVcGxvYWRSZXN1bHQge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBhdmF0YXJVcmw/OiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQXZhdGFyVXBsb2FkU2VydmljZSB7XG4gIHN0YXRpYyBhc3luYyB1cGxvYWRBdmF0YXIoZmlsZTogRmlsZSwgdXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVwbG9hZFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHw6luw6lyZXIgdW4gbm9tIGRlIGZpY2hpZXIgdW5pcXVlXG4gICAgICBjb25zdCBmaWxlRXh0ID0gZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCk7XG4gICAgICBjb25zdCBmaWxlTmFtZSA9IGAke3VzZXJJZH0tJHtEYXRlLm5vdygpfS4ke2ZpbGVFeHR9YDtcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gYGF2YXRhcnMvJHtmaWxlTmFtZX1gO1xuXG4gICAgICAvLyBVcGxvYWQgdmVycyBTdXBhYmFzZSBTdG9yYWdlXG4gICAgICBjb25zdCB7IGVycm9yOiB1cGxvYWRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2Uuc3RvcmFnZVxuICAgICAgICAuZnJvbSgndXNlci1hdmF0YXJzJylcbiAgICAgICAgLnVwbG9hZChmaWxlUGF0aCwgZmlsZSwge1xuICAgICAgICAgIGNhY2hlQ29udHJvbDogJzM2MDAnLFxuICAgICAgICAgIHVwc2VydDogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgIGlmICh1cGxvYWRFcnJvcikge1xuICAgICAgICB0aHJvdyB1cGxvYWRFcnJvcjtcbiAgICAgIH1cblxuICAgICAgLy8gT2J0ZW5pciBsJ1VSTCBwdWJsaXF1ZVxuICAgICAgY29uc3QgeyBkYXRhOiBwdWJsaWNVcmxEYXRhIH0gPSBzdXBhYmFzZS5zdG9yYWdlXG4gICAgICAgIC5mcm9tKCd1c2VyLWF2YXRhcnMnKVxuICAgICAgICAuZ2V0UHVibGljVXJsKGZpbGVQYXRoKTtcblxuICAgICAgY29uc3QgYXZhdGFyVXJsID0gcHVibGljVXJsRGF0YS5wdWJsaWNVcmw7XG5cbiAgICAgIC8vIE1ldHRyZSDDoCBqb3VyIGxlIHByb2ZpbCB1dGlsaXNhdGV1clxuICAgICAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IChzdXBhYmFzZSBhcyBhbnkpXG4gICAgICAgIC5mcm9tKCd1c2VyX3Byb2ZpbGVzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgYXZhdGFyX3VybDogYXZhdGFyVXJsLFxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfSlcbiAgICAgICAgLmVxKCdpZCcsIHVzZXJJZCk7XG5cbiAgICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgICB0aHJvdyB1cGRhdGVFcnJvcjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgYXZhdGFyVXJsLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJldXIgdXBsb2FkIGF2YXRhcjonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdJbXBvc3NpYmxlIGRlIG1ldHRyZSDDoCBqb3VyIHZvdHJlIHBob3RvLicsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBhc3luYyByZW1vdmVBdmF0YXIodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVwbG9hZFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBTdXBwcmltZXIgZHUgcHJvZmlsXG4gICAgICBjb25zdCB7IGVycm9yOiBfZXJyb3IgfSA9IGF3YWl0IChzdXBhYmFzZSBhcyBhbnkpXG4gICAgICAgIC5mcm9tKCd1c2VyX3Byb2ZpbGVzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgYXZhdGFyX3VybDogbnVsbCxcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCB1c2VySWQpO1xuXG4gICAgICBpZiAoX2Vycm9yKSB7XG4gICAgICAgIHRocm93IF9lcnJvcjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIHN1cHByZXNzaW9uIGF2YXRhcjonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdJbXBvc3NpYmxlIGRlIHN1cHByaW1lciB2b3RyZSBwaG90by4nLFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0EsTUFBQUEsVUFBQTtBQUFBO0FBQUEsQ0FBQUMsY0FBQSxHQUFBQyxDQUFBLE9BQUFDLE9BQUE7QUFRQSxNQUFhQyxtQkFBbUI7RUFDOUIsYUFBYUMsWUFBWUEsQ0FBQ0MsSUFBVSxFQUFFQyxNQUFjO0lBQUE7SUFBQU4sY0FBQSxHQUFBTyxD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