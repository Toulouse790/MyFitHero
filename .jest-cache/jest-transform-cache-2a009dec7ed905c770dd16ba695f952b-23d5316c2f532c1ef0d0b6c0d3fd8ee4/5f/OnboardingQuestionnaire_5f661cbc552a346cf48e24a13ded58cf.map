{"version":3,"names":["cov_1de05a3civ","actualCoverage","react_1","s","__importDefault","require","use_toast_1","supabase_1","ConversationalOnboarding_1","OnboardingQuestionnaire","user","onComplete","f","toast","useToast","handleConversationalComplete","data","title","description","error","_error","supabase","from","update","onboarding_completed","onboarding_completed_at","Date","toISOString","profile_type","modules","b","selectedModules","active_modules","updated_at","eq","id","console","message","code","variant","jsx_runtime_1","jsx","className","children","default","exports"],"sources":["/workspaces/MyFitHero/src/features/ai-coach/components/OnboardingQuestionnaire.tsx"],"sourcesContent":["import React from 'react';\nimport { useToast } from '@/shared/hooks/use-toast';\nimport { supabase } from '@/lib/supabase';\nimport ConversationalOnboarding from './ConversationalOnboarding';\nimport { OnboardingData } from '@/shared/types/conversationalOnboarding';\n\ninterface OnboardingQuestionnaireProps {\n  user: any;\n  onComplete: (data?: any) => void; // Rendre data optionnel car d√©j√† sauvegard√©\n}\n\nconst OnboardingQuestionnaire: React.FC<OnboardingQuestionnaireProps> = ({ user, onComplete }) => {\n  const { toast } = useToast();\n\n  // G√©rer la finalisation du nouvel onboarding\n  const handleConversationalComplete = async (data: OnboardingData) => {\n    // üéØ Ajouter feedback visuel imm√©diat\n    toast({\n      title: 'Finalisation de votre profil...',\n      description: 'Sauvegarde en cours, veuillez patienter.',\n    });\n\n    try {\n      const { error: _error } = await supabase\n        .from('user_profiles')\n        .update({\n          onboarding_completed: true,\n          onboarding_completed_at: new Date().toISOString(),\n          profile_type: 'complete',\n          modules: data.selectedModules || ['sport', 'nutrition', 'sleep', 'hydration'],\n          active_modules: data.selectedModules || ['sport', 'nutrition', 'sleep', 'hydration'],\n          updated_at: new Date().toISOString(),\n        })\n        .eq('id', user.id);\n\n      if (_error) {\n        console.error('üî¥ Erreur Supabase lors de la mise √† jour:', _error);\n        console.error(\"üî¥ D√©tails de l'erreur:\", _error.message);\n        console.error(\"üî¥ Code d'erreur:\", _error.code);\n        console.error('üî¥ User ID utilis√©:', user.id);\n\n        // ‚ö†Ô∏è M√äME EN CAS D'ERREUR, on continue vers le dashboard\n        // L'essentiel est que le profil de base existe d√©j√†\n        toast({\n          title: 'Profil partiellement sauvegard√©',\n          description:\n            \"Certaines donn√©es n'ont pas pu √™tre sauvegard√©es, mais vous pouvez continuer.\",\n          variant: 'destructive',\n        });\n\n        // ‚úÖ TOUJOURS appeler onComplete pour √©viter de bloquer l'utilisateur\n        onComplete();\n        return;\n      }\n\n\n      // üéâ FEEDBACK SUCC√àS AM√âLIORE\n      toast({\n        title: 'üéâ Bienvenue dans MyFitHero !',\n        description: 'Votre profil a √©t√© cr√©√© avec succ√®s. D√©couvrez votre tableau de bord personnalis√©.',\n      });\n\n      onComplete();\n    } catch (error: any) {\n      // Erreur silencieuse\n      console.error('üî¥ Erreur lors de la finalisation:', error);\n\n      // ‚ö†Ô∏è M√äME EN CAS D'ERREUR CRITIQUE, on redirige\n      // Mieux vaut avoir un utilisateur sur le dashboard qu'en boucle d'inscription\n      toast({\n        title: 'Erreur de sauvegarde',\n        description: 'Une erreur est survenue, mais vous pouvez acc√©der √† votre compte.',\n        variant: 'destructive',\n      });\n\n      // ‚úÖ TOUJOURS rediriger pour √©viter la boucle infinie\n      onComplete();\n    }\n  };\n\n  return (\n    <div className=\"hero-container\">\n      <ConversationalOnboarding onComplete={handleConversationalComplete} />\n    </div>\n  );\n};\n\nexport default OnboardingQuestionnaire;\n"],"mappings":"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","ignoreList":[]}