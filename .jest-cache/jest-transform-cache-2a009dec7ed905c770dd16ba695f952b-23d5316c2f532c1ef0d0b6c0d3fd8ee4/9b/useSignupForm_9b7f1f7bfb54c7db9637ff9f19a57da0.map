{"version":3,"names":["cov_2lw8zs83u1","actualCoverage","s","react_1","require","wouter_1","supabase_1","useSignupForm","f","setLocation","useLocation","formData","setFormData","useState","firstName","lastName","email","password","confirmPassword","isLoading","setIsLoading","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","successMessage","setSuccessMessage","updateField","useCallback","name","value","prev","togglePasswordVisibility","toggleConfirmPasswordVisibility","performSignup","data","authData","error","authError","supabase","auth","signUp","options","first_name","last_name","full_name","b","console","Error","message","user","profileError","from","insert","id","onboarding_completed","notifications_enabled","created_at","Date","toISOString","updated_at","setTimeout","resetForm","exports"],"sources":["/workspaces/MyFitHero/src/features/auth/hooks/useSignupForm.ts"],"sourcesContent":["import { useState, useCallback } from 'react';\nimport { useLocation } from 'wouter';\nimport { supabase } from '@/lib/supabase';\nimport { SignupFormData } from './useSignupValidation';\n\nexport const useSignupForm = () => {\n  const [, setLocation] = useLocation();\n  const [formData, setFormData] = useState<SignupFormData>({\n    firstName: '',\n    lastName: '',\n    email: '',\n    password: '',\n    confirmPassword: ''\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [successMessage, setSuccessMessage] = useState('');\n\n  const updateField = useCallback((name: keyof SignupFormData, value: string) => {\n    setFormData(prev => ({ ...prev, [name]: value }));\n  }, []);\n\n  const togglePasswordVisibility = useCallback(() => {\n    setShowPassword(prev => !prev);\n  }, []);\n\n  const toggleConfirmPasswordVisibility = useCallback(() => {\n    setShowConfirmPassword(prev => !prev);\n  }, []);\n\n  const performSignup = useCallback(async (): Promise<void> => {\n    // 1. Créer l'utilisateur dans auth.users\n    const { data: authData, error: authError } = await supabase.auth.signUp({\n      email: formData.email,\n      password: formData.password,\n      options: {\n        data: {\n          first_name: formData.firstName,\n          last_name: formData.lastName,\n          full_name: `${formData.firstName} ${formData.lastName}`\n        }\n      }\n    });\n\n    if (authError) {\n      console.error('Erreur auth:', authError);\n      throw new Error(authError.message);\n    }\n\n    if (!authData.user) {\n      throw new Error('Erreur lors de la création du compte');\n    }\n\n    // 2. Créer le profil dans user_profiles\n    const { error: profileError } = await supabase\n      .from('user_profiles')\n      .insert({\n        id: authData.user.id,\n        email: formData.email,\n        first_name: formData.firstName,\n        last_name: formData.lastName,\n        full_name: `${formData.firstName} ${formData.lastName}`,\n        onboarding_completed: false,\n        notifications_enabled: true,\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      });\n\n    if (profileError) {\n      console.error('Erreur profil:', profileError);\n      // Note: L'utilisateur auth existe déjà, on peut continuer\n    }\n\n    setSuccessMessage('Compte créé avec succès ! Vérifiez votre email pour confirmer votre inscription.');\n    \n    // Redirection après 3 secondes\n    setTimeout(() => {\n      setLocation('/dashboard');\n    }, 3000);\n  }, [formData, setLocation]);\n\n  const resetForm = useCallback(() => {\n    setFormData({\n      firstName: '',\n      lastName: '',\n      email: '',\n      password: '',\n      confirmPassword: ''\n    });\n    setSuccessMessage('');\n    setIsLoading(false);\n  }, []);\n\n  return {\n    formData,\n    isLoading,\n    showPassword,\n    showConfirmPassword,\n    successMessage,\n    updateField,\n    togglePasswordVisibility,\n    toggleConfirmPasswordVisibility,\n    performSignup,\n    resetForm,\n    setIsLoading\n  };\n};"],"mappings":"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","ignoreList":[]}